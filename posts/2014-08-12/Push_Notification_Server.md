# Sending Push Notifications
### using PushSharp

![PushSharp][img1]

---

# What is it?

[Main Site][link1]

PushSharp is a C# library to ease sending push notifications. It will allow you to send notifications to every major platform

* Android
* Amazon Kindle
* Apple
* Blackberry
* Chrome
* Windows
* Windows Phone

---

# How to get it

[NuGet page][link7]

PushSharp is available via NuGet. In your project in Visual Studio, open the Package Manager Console and run `Install-Package PushSharp`

---

# How to use it

From their docs page

```
var push = new PushBroker();

var appleCert = File.ReadAllBytes("<YOUR_CERT_FILE_NAME_HERE>.p12"));

//Send iOS notification
push.RegisterAppleService(new ApplePushChannelSettings(appleCert, "<CERT_PASSWORD_HERE>"));
push.QueueNotification(new AppleNotification()
						.ForDeviceToken("<APPLE_DEVICE_REGISTRATION_ID_HERE>")
						.WithAlert("Hello World!"));


//Send Android notification
push.RegisterGcmService(new GcmPushChannelSettings("<GCM_API_KEY_HERE>"));
push.QueueNotification(new GcmNotification()
						.ForDeviceRegistrationId("<ANDROID_DEVICE_REGISTRATION_ID_HERE>")
						.WithJson("{\"alert\":\"Hello World!\"}"));
```

First, you will need to get authorization tokens and certificates set up with Google and Apple.

---

# Google Setup

[Google Documentation Here][link3]

[PushSharp Documentation Here][link6] (note, they are a little out of date)

GCM (Google Cloud Messaging)

* Sign into [Google developer console][link2]
* Go to your console - this is where you set up projects
* Click Create Project
	* Give it a name
* Then, under APIS & AUTH -> APIs, turn on the option labelled "Google Cloud Messaging for Android"
* Under APIS & AUTH -> Credentials, click "Create New Key"
	* Select "Server Key"
	* Enter your server IP address
	* Click Create
	* That will spit out an API Key, which you will use to create a connection to Google's push servers (referred to above as `<GCM_API_KEY_HERE>`)

---

# Apple Setup

[Apple Documentation Here][link4]

[PushSharp Documentation Here][link5]

APNS (Apple Push Notification Service) works a little differently than GCM does. It requires you to have a certificate, not just an API key. Apple also has two servers, a development server and a live server. You must have a different certificate for each server.

Here are the instructions to create a certificate (from Apple):

* Click App IDs in the sidebar on the left side of the window.
* The next page displays your valid application IDs. An application ID consists of an application’s bundle ID prefixed with a ten-character code generated by Apple. The team admin must enter the bundle ID. For a certificate, it must incorporate a specific bundle ID; you cannot use a “wildcard” application ID.
* Locate the application ID for the development SSL certificate (and that is associated with the Development provisioning profile) and click Configure.
You must see “Available” under the Apple Push Notification Service column to configure a certificate for this application ID.
* In the Configure App ID page, check the Enable Push Notification Services box and click the Configure button.
Clicking this button launches an APNs Assistant, which guides you through the next series of steps.
* The first step requires that you launch the Keychain Access application and generate a Certificate Signing Request (CSR).
* Follow the instructions presented in the assistant. When you are finished generating a CSR, click Continue in Keychain Access to return to the APNs Assistant.
* When you create a CSR, Keychain Access generates a private and a public cryptographic key pair. The private key is put into your Login keychain by default. The public key is included in the CSR sent to the provisioning authority. When the provisioning authority sends the certificate back to you, one of the items in that certificate is the public key.
* In the Submit Certificate Signing Request pane, click Choose File. Navigate to the CSR file you created in the previous step and select it.
Click the Generate button.
* While displaying the Generate Your Certificate pane, the Assistant configures and generates your Client SSL Certificate. If it succeeds, it displays the message “Your APNs Certificate has been generated.” Click Continue to proceed to the next step.
* In the next pane, click the Download Now button to download the certificate file to your download location. Navigate to that location and double-click the certificate file (which has an extension of cer) to install it in your keychain. When you are finished, click Done in the APNs Assistant.
* Double-clicking the file launches Keychain Access. Make sure you install the certificate in your login keychain on the computer you are using for provider development. In Keychain Access, ensure that your certificate user ID matches your application’s bundle ID. The APNs SSL certificate should be installed on your notification server.

That gives us the certificate, but in the wrong format. We don't want this `cer` file, we want the `p12` file. Luckily, Apple has more instructions on that:

* Open Keychain Access utility and click the My Certificates category in the left pane.
* Find the certificate you want to install and disclose its contents.
* You’ll see both a certificate and a private key.
* Select both the certificate and key, choose File > Export Items, and export them as a Personal Information Exchange (.p12) file.

This file is your `<YOUR_CERT_FILE_NAME_HERE>.p12` from our PushSharp demo above

---

### Next Steps

You should be able to set up a simple project and run the above, but it won't do any good until you have device tokens to send notifications to, which is a whole different set of articles.

---

#### Sources

[https://github.com/Redth/PushSharp][link1]

[https://cloud.google.com/][link2]

[http://developer.android.com/google/gcm/gs.html][link3]

[https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW1][link4]

[https://github.com/Redth/PushSharp/wiki/How-to-Configure-&-Send-Apple-Push-Notifications-using-PushSharp][link5]

[https://github.com/Redth/PushSharp/wiki/How-to-Configure-&-Send-GCM-Google-Cloud-Messaging-Push-Notifications-using-PushSharp][link6]

[https://www.nuget.org/packages/PushSharp][link7]

[link1]: https://github.com/Redth/PushSharp
[link2]: https://cloud.google.com/
[link3]: http://developer.android.com/google/gcm/gs.html
[link4]: https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW1
[link5]: https://github.com/Redth/PushSharp/wiki/How-to-Configure-&-Send-Apple-Push-Notifications-using-PushSharp
[link6]: https://github.com/Redth/PushSharp/wiki/How-to-Configure-&-Send-GCM-Google-Cloud-Messaging-Push-Notifications-using-PushSharp
[link7]: https://www.nuget.org/packages/PushSharp

[img1]: /assets/2014-08-12/pushsharp.png